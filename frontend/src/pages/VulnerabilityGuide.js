import React from 'react';
import { FaShieldAlt, FaExclamationTriangle, FaCog, FaSnowflake } from 'react-icons/fa';
import { MdSecurity, MdReport, MdGavel, MdCardGiftcard } from 'react-icons/md';

const SeverityLevel = ({ icon: Icon, title, color, children }) => (
  <div className="bg-gray-800 rounded-lg p-6 mb-6">
    <div className="flex items-center mb-4">
      <Icon className={`text-2xl mr-3 ${color}`} />
      <h3 className="text-xl font-bold">{title}</h3>
    </div>
    {children}
  </div>
);

const CategoryTable = ({ categories }) => (
  <div className="overflow-x-auto">
    <table className="w-full text-sm">
      <thead>
        <tr className="border-b border-gray-700">
          <th className="text-left py-3 px-4">Category</th>
          <th className="text-left py-3 px-4">Description</th>
          <th className="text-left py-3 px-4">ChainRivals Example Attack Scenarios</th>
        </tr>
      </thead>
      <tbody>
        {categories.map((category, index) => (
          <tr key={index} className="border-b border-gray-700">
            <td className="py-3 px-4 font-medium">{category.name}</td>
            <td className="py-3 px-4">{category.description}</td>
            <td className="py-3 px-4">{category.example}</td>
          </tr>
        ))}
      </tbody>
    </table>
  </div>
);

function VulnerabilityGuide() {
  const criticalCategories = [
    {
      name: "Blockchain / DLT",
      description: "On-chain transaction halts or loss of NFT state that breaks core game functionality",
      example: "A bug that corrupts NFT ownership records or permanently locks player progress"
    },
    {
      name: "Smart Contracts",
      description: "Unauthorized fund withdrawal, bypass of in-game economic mechanics, or permanent game-state corruption",
      example: "Draining player or treasury tokens through economy manipulation; minting game assets without authorization"
    },
    {
      name: "Web Apps & Wallets",
      description: "Complete takeover of accounts, arbitrary transactions from user wallets, or backend API compromise",
      example: "Game portal exploits to steal private keys, or send unauthorized wallet transactions"
    }
  ];

  const highCategories = [
    {
      name: "Blockchain / DLT",
      description: "Denial of service affecting NFT minting or in-game token transfers",
      example: "A bug halting cross-chain token sync or burning essential in-game tokens"
    },
    {
      name: "Smart Contracts",
      description: "Temporary manipulation of scores, stats, or in-game rewards",
      example: "Doubling player XP using a poorly validated function"
    },
    {
      name: "Web Apps & Wallets",
      description: "Unauthorized access to session data or key game state actions",
      example: "Using a bug to reset another player's character or inventory"
    }
  ];

  const mediumCategories = [
    {
      name: "Blockchain / DLT",
      description: "Inaccurate recording of gameplay stats or minor ledger inconsistencies",
      example: "Incorrect staking calculations on-chain due to rounding issues"
    },
    {
      name: "Smart Contracts",
      description: "Poor input validation allowing unintended player actions",
      example: "Sending zero-value NFTs repeatedly to clog inventories"
    },
    {
      name: "Web Apps & Wallets",
      description: "Information leakage or limited privilege misuse",
      example: "Viewing another user's in-game profile or item stats without permission"
    }
  ];

  const lowCategories = [
    {
      name: "Blockchain / DLT",
      description: "Inconsistent data that doesn't affect function",
      example: "Metadata discrepancy in NFT attributes"
    },
    {
      name: "Smart Contracts",
      description: "Gas inefficiencies, redundant logic",
      example: "Loop consuming more gas than needed in battle logic"
    },
    {
      name: "Web Apps & Wallets",
      description: "UI glitches, frontend typos, broken links",
      example: "Typo in leaderboard or misaligned elements in the wallet integration page"
    }
  ];

  return (
    <div className="max-w-7xl mx-auto px-4 py-8">
      {/* Header Section */}
      <div className="text-center mb-12">
        <h1 className="text-4xl font-bold mb-4">üîê Vulnerability Severity Classification</h1>
        <h2 className="text-2xl text-purple-400 mb-6">ChainRivals Web3 Bug Bounty Program</h2>
        <p className="text-gray-300 max-w-3xl mx-auto">
          Welcome, whitehat hackers and security researchers üëã ‚Äî and thank you for helping us build a safer Web3.
          <br></br>At ChainRivals, security is core to our mission. We're building a decentralized gaming ecosystem where players
          interact with smart contracts, NFTs, and on-chain economies.
        </p>
      </div>

      {/* Severity Levels */}
      <div className="space-y-8">
        <SeverityLevel icon={FaShieldAlt} title="üö® Critical Severity" color="text-red-500">
          <p className="text-gray-300 mb-4">
            Impact: Immediate and widespread compromise of funds, core systems, or irreversible loss of game or asset integrity.
            Response: Immediate triage. Highest priority fix. Full reward tier.
          </p>
          <CategoryTable categories={criticalCategories} />
        </SeverityLevel>

        <SeverityLevel icon={FaExclamationTriangle} title="‚ö†Ô∏è High Severity" color="text-orange-500">
          <p className="text-gray-300 mb-4">
            Impact: Compromise of individual users or partial protocol manipulation. High trust erosion.
            Response: Rapid fix required. High reward tier.
          </p>
          <CategoryTable categories={highCategories} />
        </SeverityLevel>

        <SeverityLevel icon={FaCog} title="‚öôÔ∏è Medium Severity" color="text-yellow-500">
          <p className="text-gray-300 mb-4">
            Impact: User inconvenience, minor gameplay manipulation, or exposure of non-critical data.
            Response: Fix during next scheduled patch. Moderate reward.
          </p>
          <CategoryTable categories={mediumCategories} />
        </SeverityLevel>

        <SeverityLevel icon={FaSnowflake} title="üßä Low Severity" color="text-blue-500">
          <p className="text-gray-300 mb-4">
            Impact: Cosmetic flaws, minor bugs, or theoretical issues with no real-world impact.
            Response: Logged for future optimization. Minimal reward.
          </p>
          <CategoryTable categories={lowCategories} />
        </SeverityLevel>
      </div>

      {/* Out of Scope Section */}
      <div className="mt-12 bg-gray-800 rounded-lg p-6">
        <div className="flex items-center mb-4">
          <MdSecurity className="text-2xl mr-3 text-red-500" />
          <h3 className="text-xl font-bold">‚ùå Out of Scope & Rules</h3>
        </div>
        <p className="text-gray-300 mb-4">To maintain focus, some issues are not eligible for bounty rewards:</p>
        <ul className="list-disc list-inside text-gray-300 space-y-2">
          <li>Attacks requiring physical access or social engineering (phishing, baiting)</li>
          <li>Denial-of-service via spamming or rate-limiting bypass</li>
          <li>Low-impact UI/UX bugs (e.g. typos, grammar)</li>
          <li>Bugs on third-party tools not maintained by ChainRivals or Challenge Creator</li>
          <li>Testnet-only bugs or exploits requiring extreme attacker assumptions</li>
          <li>Automated tools without proof of exploitability</li>
        </ul>
      </div>

      {/* Responsible Disclosure Section */}
      <div className="mt-12 bg-gray-800 rounded-lg p-6">
        <div className="flex items-center mb-4">
          <MdReport className="text-2xl mr-3 text-green-500" />
          <h3 className="text-xl font-bold">üìò Responsible Disclosure Guide</h3>
        </div>
        <div className="grid md:grid-cols-2 gap-6">
          <div>
            <h4 className="font-bold mb-2">üì¨ Submit a Report</h4>
            <p className="text-gray-300 mb-4">
              Use security@chainrivals.gg or our Secure Disclosure Portal
            </p>
            <p className="text-gray-300">
              Include: vulnerability summary, reproduction steps, proof-of-concept if available, and potential impact
            </p>
          </div>
          <div>
            <h4 className="font-bold mb-2">‚è± What Happens Next?</h4>
            <ul className="list-disc list-inside text-gray-300 space-y-2">
              <li>Acknowledgment within 72 hours</li>
              <li>Triage and classification based on this guide</li>
              <li>Bounty reward eligibility if valid</li>
            </ul>
          </div>
        </div>
      </div>

      {/* Legal Safe Harbor Section */}
      <div className="mt-12 bg-gray-800 rounded-lg p-6">
        <div className="flex items-center mb-4">
          <MdGavel className="text-2xl mr-3 text-purple-500" />
          <h3 className="text-xl font-bold">‚öñÔ∏è Legal Safe Harbor</h3>
        </div>
        <p className="text-gray-300 mb-4">
          We believe ethical research should be protected. That's why ChainRivals commits to a Legal Safe Harbor:
        </p>
        <p className="text-gray-300 mb-4">
          If you act in good faith to report vulnerabilities and avoid disrupting users, ChainRivals will not pursue legal
          action or refer you to law enforcement.
        </p>
        <h4 className="font-bold mb-2">Good faith means:</h4>
        <ul className="list-disc list-inside text-gray-300 space-y-2">
          <li>No privacy violations</li>
          <li>No use of stolen funds or tokens</li>
          <li>No public disclosure before resolution</li>
          <li>No harm or disruption to users or systems</li>
        </ul>
      </div>

      {/* Bounty Claim Section */}
      <div className="mt-12 bg-gray-800 rounded-lg p-6">
        <div className="flex items-center mb-4">
          <MdCardGiftcard className="text-2xl mr-3 text-yellow-500" />
          <h3 className="text-xl font-bold">üéÅ Want to Claim Your Bounty?</h3>
        </div>
        <p className="text-gray-300 mb-4">
          Each verified bug earns a bounty based on its severity.
          Visit our Bug Bounty Portal for full reward tiers, eligible components, and program rules.
        </p>
        <div className="text-center mt-6">
          <p className="text-xl font-bold text-purple-400">Let's keep ChainRivals secure ‚Äî together.</p>
        </div>
      </div>
    </div>
  );
}

export default VulnerabilityGuide; 